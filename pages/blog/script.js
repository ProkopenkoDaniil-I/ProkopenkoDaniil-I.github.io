"use strict";function v(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var t,h="https://academy.directlinedev.com";function a(){var e=document.querySelector(".menu__sign-in-btn_js"),t=document.querySelector(".menu__register-btn_js"),n=document.querySelector(".menu__my-profile-btn_js");localStorage.getItem("token")?(e.classList.add("header__menu-item_hidden"),t.classList.add("header__menu-item_hidden"),n.classList.remove("header__menu-item_hidden")):(e.classList.remove("header__menu-item_hidden"),t.classList.remove("header__menu-item_hidden"),n.classList.add("header__menu-item_hidden"))}function e(e,t,n,i,o,s){var e=0<arguments.length&&void 0!==e?e:null,t=1<arguments.length?t:void 0,n=2<arguments.length?n:void 0,a=3<arguments.length?i:void 0,o=4<arguments.length?o:void 0,r=5<arguments.length?s:void 0,l=document.querySelector(".".concat(t)),c=document.querySelector(".".concat(o)),n=document.querySelector(".".concat(n)),d=l.querySelector("input");function u(){g(l,a,c,r)}l&&n&&(e&&document.querySelector(".".concat(e)).addEventListener("click",function(){l.classList.add(a),d&&d.focus();c&&c.classList.add(r)}),n.addEventListener("click",u),window.addEventListener("keydown",function(e){27===e.keyCode&&l.classList.contains(a)&&u()}))}function g(e,t,n,i){n=2<arguments.length&&void 0!==n&&n,i=3<arguments.length?i:void 0;e.classList.remove(t),n&&n.classList.remove(i)}function f(e,t){if(!e)return!1;var n=!0;return t.forEach(function(e){!function(e){e.classList.remove("text-input-field_invalid"),e.nextElementSibling.classList.add("hidden"),e.classList.add("text-input-field_valid"),e.nextElementSibling.nextElementSibling.classList.contains("hidden")&&e.nextElementSibling.nextElementSibling.classList.remove("hidden");e.nextElementSibling.nextElementSibling.nextElementSibling&&e.nextElementSibling.nextElementSibling.nextElementSibling.remove()}(e),e.isValid()||(n=!1,o(e))}),n}function _(e,t){if(!e)return!1;var n=!0;return(e=t).nextElementSibling.classList.contains("checkbox-input-error")&&e.nextElementSibling.classList.remove("checkbox-input-error"),t.isValid()||(n=!1,(t=t).nextElementSibling.classList.contains("checkbox-input-error")||t.nextElementSibling.classList.add("checkbox-input-error")),n}function o(e){e.classList.add("text-input-field_invalid"),e.nextElementSibling.classList.remove("hidden"),e.nextElementSibling.nextElementSibling.classList.contains("hidden")||e.nextElementSibling.nextElementSibling.classList.add("hidden"),e.classList.contains("text-input-field_valid")&&e.classList.remove("text-input-field_valid")}function b(e){return e.match(/^[0-9a-z-\.]+\@[0-9a-z-]{2,}\.[a-z]{2,}$/i)}function S(e){return 5<e.length}function y(e,t,n){t=1<arguments.length&&void 0!==t?t:null,n=2<arguments.length&&void 0!==n?n:null;e.forEach(function(e){!function(e){e.classList.contains("text-input-field_invalid")&&e.classList.remove("text-input-field_invalid");e.classList.contains("text-input-field_valid")&&e.classList.remove("text-input-field_valid");e.nextElementSibling&&e.nextElementSibling.nextElementSibling&&!e.nextElementSibling.nextElementSibling.classList.contains("hidden")&&e.nextElementSibling.nextElementSibling.classList.add("hidden");e.nextElementSibling&&!e.nextElementSibling.classList.contains("hidden")&&e.nextElementSibling.classList.add("hidden")}(e),e.value=""}),t&&((e=t).nextElementSibling.classList.contains("checkbox-input-error")&&e.nextElementSibling.classList.remove("checkbox-input-error"),t.checked=!1),n&&w(t,n)}function w(e,t){e.checked&&t.hasAttribute("disabled")&&t.removeAttribute("disabled"),e.checked||t.hasAttribute("disabled")||t.setAttribute("disabled","")}function L(e){var t=e.url,n=e.method,i=e.headers,e=e.body;return fetch(h+t+"?v=1.0.0",{method:void 0===n?"GET":n,headers:i,body:void 0===e?null:e})}function x(n,i){Object.keys(n).length&&Object.keys(n).forEach(function(e){var t=n[e];!function(e,t){o(e);var n=document.createElement("div");n.classList.add("text-input-error"),n.innerText=t,e.nextElementSibling.classList.contains("hidden")||e.nextElementSibling.classList.add("hidden"),e.nextElementSibling.nextElementSibling.classList.contains("hidden")||e.nextElementSibling.nextElementSibling.classList.add("hidden"),e.nextElementSibling.nextElementSibling.nextElementSibling?e.nextElementSibling.nextElementSibling.nextElementSibling.innerText=t:e.nextElementSibling.nextElementSibling.insertAdjacentElement("afterend",n)}(i.elements[e],t)})}document.querySelector(".".concat("menu__my-blog-btn_js")).classList.add("header__menu-item_current"),a(),e("menu__sign-in-btn_js","sign-in-form_js","sign-in-form__close-btn_js","popup-form_open","sign-in-overlay_js","popup-overlay_open"),e("menu__register-btn_js","register-form_js","register-form__close-btn_js","popup-form_open","register-overlay_js","popup-overlay_open"),e("send-message-btn_js","send-message-form_js","send-message-form__close-btn_js","popup-form_open","send-message-overlay_js","popup-overlay_open"),e("mobile__menu-burger_js","popup-menu_js","header__popup-menu-close-btn_js","popup-menu_open"),(t=document.querySelector(".button-to-top_js"))&&(t.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}),window.addEventListener("scroll",function(e){1500<window.pageYOffset&&t.classList.remove("button-to-top_hidden"),window.pageYOffset<=1500&&t.classList.add("button-to-top_hidden")})),function(){var e=document.forms.signIn,t=e.elements.email,n=e.elements.password;t.isValid=function(){return b(t.value)},n.isValid=function(){return S(n.value)};var i=[t,n],o=!1;e.addEventListener("submit",function(e){e.preventDefault(),f(o=!0,i)&&function(){var t=document.querySelector(".sign-in-form_js"),n=document.querySelector(".preloader__loader_js"),i=document.forms.signIn,o=document.querySelector(".sign-in-overlay_js");n.classList.remove("preloader_hidden");var e={};e.email=i.email.value,e.password=i.password.value;var s=[i.email,i.password];L({method:"POST",url:"/api/users/login",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw e;localStorage.setItem("token",e.data.token),localStorage.setItem("userId",e.data.userId),y(s),g(t,"popup-form_open",o,"popup-overlay_open"),n.classList.add("preloader_hidden"),a(),setTimeout(function(){location.pathname="/pages/profile"},2e3)}).catch(function(e){e._message&&x({email:e._message},i)}).finally(function(){n.classList.add("preloader_hidden")})}()}),i.forEach(function(e){e.addEventListener("input",function(){f(o,i)})})}(),function(){var e=document.forms.register,t=e.elements.email,n=e.elements.name,i=e.elements.surname,o=e.elements.password,s=e.elements.passwordRepeat,a=e.elements.location,r=e.elements.age,l=e.elements.confirm,c=e.elements.submitButton;t.isValid=function(){return b(t.value)},n.isValid=function(){return!!n.value},i.isValid=function(){return!!i.value},o.isValid=function(){return S(o.value)},s.isValid=function(){return e=o.value,t=s.value,S(e)&&e===t;var e,t},a.isValid=function(){return!!a.value},r.isValid=function(){return e=r.value,!isNaN(e)&&null!==e&&0<e;var e},l.isValid=function(){return l.checked};var d=[t,n,i,o,s,a,r],u=!1,m=!1,p=!1;e.addEventListener("submit",function(e){e.preventDefault(),u=f(p=!0,d),m=_(p,l),u&&m&&function(){var t=document.querySelector(".register-form_js"),n=document.querySelector(".preloader__loader_js"),i=document.forms.register,o=document.querySelector(".register-overlay_js"),s=i.elements.submitButton,e={};e.email=i.email.value,e.name=i.name.value,e.surname=i.surname.value,e.password=i.password.value,e.location=i.location.value,e.age=+i.age.value;var a=[i.email,i.name,i.surname,i.password,i.passwordRepeat,i.location,i.age];n.classList.remove("preloader_hidden"),L({method:"POST",url:"/api/users",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw e;y(a,i.confirm,s),g(t,"popup-form_open",o,"popup-overlay_open"),alert("Пользователь с id ".concat(e.data.id," & email ").concat(e.data.email," создан!")),n.classList.add("preloader_hidden")}).catch(function(e){x(e.errors,i)}).finally(function(){n.classList.add("preloader_hidden")})}()}),d.forEach(function(e){e.addEventListener("input",function(){u=f(p,d)})}),l.addEventListener("input",function(){m=_(p,l)}),l.addEventListener("input",function(){w(l,c)})}(),function(){var e=document.forms.sendMessage,t=e.elements.to,n=e.elements.name,i=e.elements.subject,o=e.elements.phone,s=e.elements.confirm,a=e.elements.submitButton;t.isValid=function(){return b(t.value)},n.isValid=function(){return!!n.value},i.isValid=function(){return!!i.value},o.isValid=function(){return o.value.match(/^(\s*)?(\+)?([-_():=+]?\d[- _():=+]?){10,14}(\s*)?$/)},s.isValid=function(){return s.checked};var r=[t,n,i,o],l=!1,c=!1,d=!1;e.addEventListener("submit",function(e){e.preventDefault(),l=f(d=!0,r),c=_(d,s),l&&c&&function(){var t=document.querySelector(".send-message-form_js"),n=document.querySelector(".preloader__loader_js"),i=document.forms.sendMessage,o=document.querySelector(".send-message-overlay_js"),s=i.elements.submitButton,e=i.name.value,a=i.subject.value,r=i.phone.value,l=i.message.value,c={};c.to=i.to.value,c.body=JSON.stringify({myName:e,mySubject:a,myPhone:r,myMessage:l});var d=[i.to,i.name,i.subject,i.phone,i.message];n.classList.remove("preloader_hidden"),L({method:"POST",url:"/api/emails",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw e;y(d,i.confirm,s),g(t,"popup-form_open",o,"popup-overlay_open"),n.classList.add("preloader_hidden"),alert("Ваше сообщение успешно отправлено!")}).catch(function(e){console.log("Получили ошибку с сервера"),e.errors&&x(e.errors,i)}).finally(function(){n.classList.add("preloader_hidden")})}()}),r.forEach(function(e){e.addEventListener("input",function(){l=f(d,r)})}),s.addEventListener("input",function(){c=_(d,s)}),s.addEventListener("input",function(){w(s,a)})}(),function(){var o=5,l=["01","02","03","04","05","06","07","08","09","10","11","12"],e={name:"",tags:[""],views:"",comments:[""],howShow:"",sortBy:""},t=document.forms.filter,n=document.querySelector(".blogs-control-panel__reset-btn_js"),c=document.querySelector(".myblog-button_back_js"),d=document.querySelector(".myblog-button_next_js"),i=document.querySelector(".preloader__loader_js"),s=0;t.addEventListener("submit",function(e){e.preventDefault();e={page:0};e.name=t.elements.name.value,e.tags=v(t.elements.tags).filter(function(e){return e.checked}).map(function(e){return e.value}),e.views=(v(t.elements.views).find(function(e){return e.checked})||{value:null}).value,e.comments=v(t.elements.comments).filter(function(e){return e.checked}).map(function(e){return e.value}),e.howShow=(v(t.elements.howShow).find(function(e){return e.checked})||{value:null}).value,e.sortBy=(v(t.elements.sortBy).find(function(e){return e.checked})||{value:null}).value,m(e),function(e){var t=new URLSearchParams;t.set("name",e.name),e.tags.forEach(function(e){t.append("tags",e)}),e.views&&t.set("views",e.views);e.comments.forEach(function(e){t.append("comments",e)}),e.howShow&&t.set("howShow",e.howShow);e.sortBy&&t.set("sortBy",e.sortBy);e.page?t.append("page",e.page):t.set("page",0);history.replaceState(null,document.title,"?"+t.toString()),localStorage.setItem("searchParams",t.toString())}(e)});var a=new XMLHttpRequest;function u(){var e=new URLSearchParams(location.search);return{name:e.get("name")||"",tags:e.getAll("tags"),views:e.get("views"),comments:e.getAll("comments"),howShow:e.get("howShow"),sortBy:e.get("sortBy"),page:+e.get("page")||0}}function r(t){var e=document.forms.filter;e.elements.name.value=t.name,e.elements.tags.forEach(function(e){e.checked=t.tags.includes(e.value)}),e.elements.views.forEach(function(e){e.checked=t.views===e.value}),e.elements.comments.forEach(function(e){e.checked=t.comments.includes(e.value)}),e.elements.howShow.forEach(function(e){e.checked=t.howShow===e.value}),e.elements.sortBy.forEach(function(e){e.checked=t.sortBy===e.value})}function m(e){var s=new XMLHttpRequest,t=new URLSearchParams;t.set("v","1.0.0"),e.tags&&Array.isArray(e.tags)&&e.tags.length&&t.set("tags",JSON.stringify(e.tags));var n={};e.name&&(n.title=e.name);var i,a=o;+e.howShow&&(a=+e.howShow),t.set("limit",a),e.views&&(i=e.views.split("-"),n.views={$between:i}),e.comments.length&&(i=[e.comments[0].split("-")[0],e.comments[e.comments.length-1].split("-")[1]],n.commentsCount={$between:i}),t.set("filter",JSON.stringify(n)),+e.page&&t.set("offset",+e.page*a),e.sortBy&&t.set("sort",JSON.stringify([e.sortBy,"ASC"])),s.open("GET",h+"/api/posts?"+t.toString()),s.send(),g(),s.onload=function(){var e=JSON.parse(s.response),r="";e.data.forEach(function(e){var t,n,i,o,s,a;r+=(t={title:e.title,text:e.text,photo:e.photo,tags:e.tags,commentsCount:e.commentsCount,date:new Date(e.date),views:e.views},n=t.title,i=t.text,o=t.photo,s=t.tags,a=t.commentsCount,e=t.date,t=t.views,'\n        <section class="myblog__main-item blog-item">   \n            <picture class="blog-item__img-wrapper">\n                <source class="blog-item__img" media="screen and (min-width: 1200px)" srcset="'.concat(h).concat(o.desktopPhotoUrl,", ").concat(h).concat(o.desktop2xPhotoUrl,' 2x">\n                <source class="blog-item__img" media="screen and (min-width: 768px) and (max-width: 1199px)" srcset="').concat(h).concat(o.tabletPhotoUrl,", ").concat(h).concat(o.tablet2xPhotoUrl,' 2x">\n                <source class="blog-item__img" media="screen and (max-width: 767px)" srcset="').concat(h).concat(o.mobilePhotoUrl,", ").concat(h).concat(o.mobile2xPhotoUrl,' 2x">\n                <img class="blog-item__img" src="').concat(h).concat(o.desktopPhotoUrl,'" alt="').concat(n,'">\n            </picture>\n            <div class="blog-item__text-block">\n                <div class="blog-item__tags">\n                    ').concat(s.map(function(e){return'<div class="blog-item__tags-item" style="background-color: '.concat(e.color,'"></div>')}).join(""),'\n                </div>\n                <div class="blog-item__dates">\n                    <div class="blog-item__dates-item blog-item__post-date">').concat(e.getDate(),".").concat(l[e.getMonth()],".").concat(e.getFullYear(),'</div>\n\n                    <div class="blog-item__dates-item blog-item__post-views">').concat(t,' views</div>\n                    <div class="blog-item__dates-item blog-item__post-comments">').concat(a,' comments</div>\n                </div>\n                <h3 class="blog-item__title">').concat(n,'</h3>\n                <p class="blog-item__text">').concat(i,'</p>\n                <a class="blog-item__link" href="#">Go to this post</a>\n            </div>\n        </section>'))}),document.querySelector(".result_js").innerHTML=r;var t=document.querySelector(".pagination_js");t.innerHTML="";for(var n=Math.ceil(e.count/a),i=0;i<n;i++){var o=function(t){var e=document.createElement("a");e.href="?page="+t,e.innerText=""+(t+1),e.classList.add("pagination-panel__pagination-link"),e.classList.add("pagination-link_js");var n=u();t===+n.page&&e.classList.add("pagination-link_active");return e.addEventListener("click",function(e){e.preventDefault(),p(t)}),e}(i);t.insertAdjacentElement("beforeend",o)}0<u().page&&c.removeAttribute("disabled"),u().page<n-1&&d.removeAttribute("disabled"),0===u().page&&c.setAttribute("disabled",""),u().page!==n-1&&0!==n||d.setAttribute("disabled",""),f()}}function p(e){var t=document.querySelectorAll(".pagination-link_js"),n=new URLSearchParams(location.search);t[u().page].classList.remove("pagination-link_active"),n.set("page",e),t[e].classList.add("pagination-link_active"),history.replaceState(null,document.title,"?"+n.toString()),m(u())}function g(){s++,i.classList.remove("preloader_hidden")}function f(){--s<=0&&(i.classList.add("preloader_hidden"),s=0)}a.open("GET",h+"/api/tags"),a.send(),g(),a.onload=function(){var e=JSON.parse(a.response).data,n=document.querySelector(".blogs-control-panel__column-tags-wrapper_js");e.forEach(function(e){var t,t=(t={id:e.id,name:e.name,color:e.color},e=t.id,t.name,t=t.color,'\n        <input type="checkbox" name="tags" id="tags-'.concat(e,'" value="').concat(e,'">\n        <label for="tags-').concat(e,'" class="checkbox-label-tag">\n            <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <rect x="1.25" y="1.25" width="22.5" height="22.5" rx="3.75" stroke="').concat(t,'" stroke-width="2.5"/>\n                <path d="M7 11.75L10.913 17.77C11.2013 18.2135 11.8584 18.1893 12.1133 17.7259L18.425 6.25" stroke="').concat(t,'" stroke-opacity="0" stroke-width="2.5" stroke-linecap="round"/>\n            </svg>\n        </label>'));n.insertAdjacentHTML("beforeend",t)}),!location.search.length&&localStorage.getItem("searchParams")&&(location.search=localStorage.getItem("searchParams"));e=u();r(e),m(e),f()},n.addEventListener("click",function(){r(e)}),c.addEventListener("click",function(){p(u().page-1)}),d.addEventListener("click",function(){p(u().page+1)})}();